{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 67123183d43ddc3f3486","webpack:///./src/crocotile.js","webpack:///./src/util/program.js"],"names":["crocotileUnlitVS","crocotileUnlitFS","loadTexture","gl","src","texture","createTexture","img","Image","addEventListener","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","CrocotileModel","json","vertices","indices","object","p","position","i","faces","length","face","uvs","j","v","push","x","y","z","vertexCount","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","program","vertexAttribPointer","attrib","FLOAT","texCoord","drawArrays","TRIANGLES","CrocotileScene","config","models","bindAttribLocation","link","projection","modelView","use","uniformMatrix4fv","uniform","projectionMat","modelViewMat","enableVertexAttribArray","activeTexture","TEXTURE0","uniform1i","diffuse","model","draw","CrocotileLoader","url","loader","fetch","then","response","scene","Program","vertexSource","fragmentSource","createProgram","_firstUse","_vertexShader","_fragmentShader","attachShaderSource","VERTEX_SHADER","FRAGMENT_SHADER","source","type","shader","createShader","console","Error","attachShader","shaderSource","compileShader","self","Promise","resolve","reject","xhr","XMLHttpRequest","ev","status","statusText","open","send","tagId","shaderTag","document","getElementById","error","k","firstChild","nodeType","textContent","nextSibling","attribLocationMap","attribName","varyings","transformFeedbackVaryings","linkProgram","getProgramParameter","LINK_STATUS","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","getProgramInfoLog","deleteProgram","attribCount","ACTIVE_ATTRIBUTES","attribInfo","getActiveAttrib","name","getAttribLocation","uniformCount","ACTIVE_UNIFORMS","uniformName","uniformInfo","getActiveUniform","replace","getUniformLocation","deleteShader","useProgram"],"mappings":"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","file":"crocotile.debug.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 67123183d43ddc3f3486\n **/","/*\nCopyright (c) 2016, Brandon Jones.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n*/\n\nimport Program from \"./util/program\";\n\nconst crocotileUnlitVS = `\n  uniform mat4 projectionMat;\n  uniform mat4 modelViewMat;\n  attribute vec3 position;\n  attribute vec2 texCoord;\n  varying vec2 vTexCoord;\n\n  void main() {\n    vTexCoord = texCoord;\n    gl_Position = projectionMat * modelViewMat * vec4( position, 1.0 );\n  }\n`;\n\nconst crocotileUnlitFS = `\n  precision mediump float;\n  uniform sampler2D diffuse;\n  varying vec2 vTexCoord;\n\n  void main() {\n    vec4 color = texture2D(diffuse, vTexCoord);\n    if (color.a < 0.1) {\n      discard;\n    }\n    gl_FragColor = color;\n  }\n`;\n\nfunction loadTexture(gl, src) {\n  let texture = gl.createTexture();\n\n  let img = new Image();\n  img.addEventListener('load', function() {\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, img);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n  });\n  img.src = src;\n\n  return texture;\n}\n\n/**\n * CrocotileModel\n *\n * @module CrocotileModel\n */\n\nclass CrocotileModel {\n  constructor(gl, json) {\n    this.gl = gl;\n    this.texture = loadTexture(gl, json.texture);\n\n    // Load the mesh\n    let vertices = [];\n    let indices = [];\n\n    for (let object of json.object) {\n      let p = object.position;\n\n      for (let i = 0; i < object.faces.length; ++i) {\n        let face = object.faces[i];\n        let uvs = object.uvs[i];\n        for (let j = 0; j < face.length; ++j) {\n          let v = object.vertices[face[j]];\n          vertices.push(v.x + p.x, v.y + p.y, v.z + p.z);\n          vertices.push(uvs[j].x, (uvs[j].y * -1) + 1.0);\n        }\n      }\n    }\n\n    this.vertexCount = vertices.length / 5;\n    this.vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\n  }\n\n  draw(program) {\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n    gl.vertexAttribPointer(program.attrib.position, 3, gl.FLOAT, false, 20, 0);\n    gl.vertexAttribPointer(program.attrib.texCoord, 2, gl.FLOAT, false, 20, 12);\n\n    gl.drawArrays(gl.TRIANGLES, 0, this.vertexCount);\n  }\n}\n\n/**\n * CrocotileScene\n *\n * @module CrocotileScene\n */\n\nclass CrocotileScene {\n  constructor(gl, config) {\n    this.gl = gl;\n\n    this.config = config;\n    this.models = [];\n\n    this.program = new Program(gl, crocotileUnlitVS, crocotileUnlitFS);\n    this.program.bindAttribLocation({\n      position: 0,\n      texCoord: 1\n    });\n    this.program.link();\n  }\n\n  draw(projection, modelView) {\n    var gl = this.gl;\n    var program = this.program;\n\n    program.use();\n\n    gl.uniformMatrix4fv(program.uniform.projectionMat, false, projection);\n    gl.uniformMatrix4fv(program.uniform.modelViewMat, false, modelView);\n\n    gl.enableVertexAttribArray(program.attrib.position);\n    gl.enableVertexAttribArray(program.attrib.texCoord);\n\n    gl.activeTexture(gl.TEXTURE0);\n    gl.uniform1i(program.uniform.diffuse, 0);\n\n    for (let model of this.models) {\n      model.draw(program);\n    }\n  }\n}\n\n/**\n * CrocotileLoader\n *\n * @module CrocotileLoader\n */\nexport class CrocotileLoader {\n  constructor(gl) {\n    this.gl = gl;\n  }\n\n  load(url) {\n    let loader = this;\n\n    return fetch(url).then(function(response) {\n      return response.json().then(function(json) {\n        let scene = new CrocotileScene(gl, json.config);\n\n        for (let model of json.model) {\n          scene.models.push(new CrocotileModel(gl, model));\n        }\n\n        return scene;\n      });\n    });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/crocotile.js\n **/","/*\nCopyright (c) 2016, Brandon Jones.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n*/\n\n/**\n * Program\n * Utility class to make loading shader programs easier. Does all the error\n * checking you typically want, automatically queries uniform and attribute\n * locations, and attempts to take advantage of some browser's ability to link\n * asynchronously by not querying any information from the program until it's\n * first use.\n * @module Program\n */\n\nexport default class Program {\n  constructor (gl, vertexSource, fragmentSource) {\n    this.gl = gl;\n    this.program = gl.createProgram();\n    this.attrib = null;\n    this.uniform = null;\n\n    this._firstUse = true;\n    this._vertexShader = null;\n    this._fragmentShader = null;\n\n    if (vertexSource)\n      this.attachShaderSource(vertexSource, gl.VERTEX_SHADER);\n\n    if (fragmentSource)\n      this.attachShaderSource(fragmentSource, gl.FRAGMENT_SHADER);\n  }\n\n  attachShaderSource(source, type) {\n    let gl = this.gl;\n    let shader;\n\n    switch (type) {\n      case gl.VERTEX_SHADER:\n        this._vertexShader = gl.createShader(type);\n        shader = this._vertexShader;\n        break;\n      case gl.FRAGMENT_SHADER:\n        this._fragmentShader = gl.createShader(type);\n        shader = this._fragmentShader;\n        break;\n      default:\n        console.Error(\"Invalid Shader Type:\", type);\n        return;\n    }\n\n    gl.attachShader(this.program, shader);\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n  }\n\n  attachShaderSourceFromXHR(url, type) {\n    var self = this;\n    return new Promise(function(resolve, reject) {\n      let xhr = new XMLHttpRequest();\n      xhr.addEventListener(\"load\", function (ev) {\n        if (xhr.status == 200) {\n          self.attachShaderSource(xhr.response, type);\n          resolve();\n        } else {\n          reject(xhr.statusText);\n        }\n      }, false);\n      xhr.open(\"GET\", url, true);\n      xhr.send(null);\n    });\n  }\n\n  attachShaderSourceFromTag(tagId, type) {\n    let shaderTag = document.getElementById(tagId);\n    if (!shaderTag) {\n      console.error(\"Shader source tag not found:\", tagId);\n      return;\n    }\n\n    if (!type) {\n      if (shaderTag.type == \"x-shader/x-vertex\") {\n        type = this.gl.VERTEX_SHADER;\n      } else if (shaderTag.type == \"x-shader/x-fragment\") {\n        type = this.gl.FRAGMENT_SHADER;\n      } else {\n        console.error(\"Invalid Shader Type:\", shaderTag.type);\n        return;\n      }\n    }\n\n    let src = \"\";\n    let k = shaderTag.firstChild;\n    while (k) {\n      if (k.nodeType == 3) {\n        src += k.textContent;\n      }\n      k = k.nextSibling;\n    }\n    this.attachShaderSource(src, type);\n  }\n\n  bindAttribLocation(attribLocationMap) {\n    let gl = this.gl;\n\n    if (attribLocationMap) {\n      this.attrib = {};\n      for (var attribName in attribLocationMap) {\n        gl.bindAttribLocation(this.program, attribLocationMap[attribName], attribName);\n        this.attrib[attribName] = attribLocationMap[attribName];\n      }\n    }\n  }\n\n  transformFeedbackVaryings(varyings, type) {\n    this.gl.transformFeedbackVaryings(this.program, varyings, type);\n  }\n\n  link() {\n    this.gl.linkProgram(this.program);\n  }\n\n  use() {\n    let gl = this.gl;\n\n    // If this is the first time the program has been used do all the error checking and\n    // attrib/uniform querying needed.\n    if (this._firstUse) {\n      if (!gl.getProgramParameter(this.program, gl.LINK_STATUS)) {\n        if (this._vertexShader && !gl.getShaderParameter(this._vertexShader, gl.COMPILE_STATUS)) {\n          console.error(\"Vertex shader compile error:\", gl.getShaderInfoLog(this._vertexShader));\n        } else if (this._fragmentShader && !gl.getShaderParameter(this._fragmentShader, gl.COMPILE_STATUS)) {\n          console.error(\"Fragment shader compile error:\", gl.getShaderInfoLog(this._fragmentShader));\n        } else {\n          console.error(\"Program link error:\", gl.getProgramInfoLog(this.program));\n        }\n        gl.deleteProgram(this.program);\n        this.program = null;\n      } else {\n        if (!this.attrib) {\n          this.attrib = {};\n          let attribCount = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\n          for (let i = 0; i < attribCount; i++) {\n            let attribInfo = gl.getActiveAttrib(this.program, i);\n            this.attrib[attribInfo.name] = gl.getAttribLocation(this.program, attribInfo.name);\n          }\n        }\n\n        this.uniform = {};\n        let uniformCount = gl.getProgramParameter(this.program, gl.ACTIVE_UNIFORMS);\n        let uniformName = \"\";\n        for (let i = 0; i < uniformCount; i++) {\n          let uniformInfo = gl.getActiveUniform(this.program, i);\n          uniformName = uniformInfo.name.replace(\"[0]\", \"\");\n          this.uniform[uniformName] = gl.getUniformLocation(this.program, uniformName);\n        }\n      }\n      gl.deleteShader(this._vertexShader);\n      gl.deleteShader(this._fragmentShader);\n      this._firstUse = false;\n    }\n\n    gl.useProgram(this.program);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/program.js\n **/"],"sourceRoot":""}